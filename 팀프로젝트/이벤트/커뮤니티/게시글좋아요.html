<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>추천/비추천 버튼</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        /* 버튼들을 감싸는 영역 */
        .vote-wrap {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
            font-family: sans-serif;
        }

        /* 개별 버튼 기본 스타일 (위: 아이콘, 아래: 숫자) */
        .vote-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            background: none;
            border: none;
            cursor: pointer;
            color: #aaa; /* 기본 회색 */
            padding: 10px 15px;
            transition: all 0.2s;
        }

        /* 아이콘 크기 및 애니메이션 */
        .vote-btn .icon {
            font-size: 28px;
            transition: transform 0.2s;
        }

        /* 마우스 올렸을 때 살짝 커지는 효과 */
        .vote-btn:hover .icon {
            transform: scale(1.15);
        }

        /* 숫자 스타일 */
        .vote-btn .cnt {
            font-size: 14px;
            font-weight: bold;
        }

        /* 활성화(on) 상태 색상 - 추천은 파란색, 비추천은 빨간색 */
        .vote-btn.like.on { color: #007bff; }
        .vote-btn.dislike.on { color: #ff4757; }
    </style>
</head>
<body>

    <div class="vote-wrap" data-post="101">
        <button class="vote-btn like" onclick="handleVote(this, 'up')">
            <i class="fa-regular fa-thumbs-up icon"></i>
            <span class="cnt">0</span>
        </button>
        
        <button class="vote-btn dislike" onclick="handleVote(this, 'down')">
            <i class="fa-regular fa-thumbs-down icon"></i>
            <span class="cnt">0</span>
        </button>
    </div>

    <script>
        // 추천/비추천 통합 제어 함수 (this와 type을 받아와서 제어)
        function handleVote(clickedBtn, type) {
            // 1. 클릭된 버튼이 속한 게시글 영역과 게시글 번호(postId) 가져오기
            const wrap = clickedBtn.closest('.vote-wrap');
            const postId = wrap.dataset.post;
            
            // 2. 해당 영역 안의 추천/비추천 버튼과 카운트 요소 찾기
            const likeBtn = wrap.querySelector('.like');
            const dislikeBtn = wrap.querySelector('.dislike');
            const likeCnt = likeBtn.querySelector('.cnt');
            const dislikeCnt = dislikeBtn.querySelector('.cnt');
            
            // 3. 현재 켜져 있는지(on) 상태 확인
            const isLikeOn = likeBtn.classList.contains('on');
            const isDislikeOn = dislikeBtn.classList.contains('on');

            if (type === 'up') {
                // [추천 버튼을 눌렀을 때]
                if (isLikeOn) {
                    // 이미 추천했다면 -> 추천 취소
                    toggleState(likeBtn, likeCnt, -1);
                } else {
                    // 추천하기
                    toggleState(likeBtn, likeCnt, 1);
                    // 만약 비추천이 눌려있었다면 -> 비추천 취소 (중복 방지)
                    if (isDislikeOn) toggleState(dislikeBtn, dislikeCnt, -1);
                }
            } else if (type === 'down') {
                // [비추천 버튼을 눌렀을 때]
                if (isDislikeOn) {
                    // 이미 비추천했다면 -> 비추천 취소
                    toggleState(dislikeBtn, dislikeCnt, -1);
                } else {
                    // 비추천하기
                    toggleState(dislikeBtn, dislikeCnt, 1);
                    // 만약 추천이 눌려있었다면 -> 추천 취소 (중복 방지)
                    if (isLikeOn) toggleState(likeBtn, likeCnt, -1);
                }
            }

            // DB 통신을 위한 콘솔 확인 (팀원들이 여기에 AJAX를 연결하면 됨)
            console.log(`게시글 ${postId}번 | 동작: ${type} | 현재상태: ${clickedBtn.classList.contains('on') ? '추가' : '취소'}`);
        }

        // 디자인(클래스)과 숫자(카운트)를 변경해주는 공통 함수
        function toggleState(btn, cntElement, change) {
            const icon = btn.querySelector('.icon');
            let currentNum = parseInt(cntElement.innerText);

            if (change > 0) {
                btn.classList.add('on');
                icon.classList.replace('fa-regular', 'fa-solid'); // 꽉 찬 따봉으로
            } else {
                btn.classList.remove('on');
                icon.classList.replace('fa-solid', 'fa-regular'); // 빈 따봉으로
            }
            
            cntElement.innerText = currentNum + change;
        }
    </script>
</body>
</html>